<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ULT Data</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h2>ULT Data</h2>
    <table>
        <thead>
            <tr>
                <th>Data</th>
                <th>Geração</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr>
                <td>{{ row[0] }}</td>
                <td>{{ row[1] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        // Função para realizar o download do PDF assim que a página for carregada
        window.onload = function() {
            // Fazer uma requisição AJAX para a rota que gera o PDF
            const xhr = new XMLHttpRequest();
            xhr.open('GET', window.location.href, true);
            xhr.responseType = 'blob'; // Indicar que a resposta é um blob (arquivo binário)
            xhr.onload = function() {
                // Verificar se a requisição foi bem-sucedida
                if (xhr.status === 200) {
                    // Criar um URL temporário para o blob
                    const url = window.URL.createObjectURL(xhr.response);

                    // Criar um link <a> para fazer o download do arquivo
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'ult_data.pdf'; // Nome do arquivo para download
                    document.body.appendChild(link);

                    // Clicar automaticamente no link para iniciar o download
                    link.click();

                    // Liberar o URL temporário após o download
                    window.URL.revokeObjectURL(url);
                }
            };
            xhr.send();
        };
    </script>
</body>
</html>
